<Window x:Class="Project_bpi.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Project_bpi"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        mc:Ignorable="d"
        Title="MainWindow" Height="700" Width="900">

    <Window.Resources>

        <Style x:Key="CustomScrollBar" TargetType="{x:Type ScrollBar}">
            <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
            <Setter Property="Foreground" Value="#CCCCCC"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Width" Value="8"/>
            <Setter Property="MinWidth" Value="8"/>
            <Setter Property="Opacity" Value="0.3"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ScrollBar}">
                        <Grid x:Name="Bg" Background="{TemplateBinding Background}" SnapsToDevicePixels="True">
                            <Track x:Name="PART_Track" IsDirectionReversed="true" IsEnabled="{TemplateBinding IsMouseOver}">
                                <Track.Thumb>
                                    <Thumb Style="{DynamicResource ScrollBarThumbVertical}"/>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Opacity" Value="1"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Стиль для Thumb (бегунка) -->
        <Style x:Key="ScrollBarThumbVertical" TargetType="{x:Type Thumb}">
            <Setter Property="OverridesDefaultStyle" Value="true"/>
            <Setter Property="IsTabStop" Value="false"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Border x:Name="rectangle"
                            Width="8"
                            Background="#A0A0A0"
                            CornerRadius="4"
                            SnapsToDevicePixels="True"/>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="rectangle" Property="Background" Value="#707070"/>
                            </Trigger>
                            <Trigger Property="IsDragging" Value="True">
                                <Setter TargetName="rectangle" Property="Background" Value="#505050"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Стиль для ScrollViewer с красивым скроллом -->
        <Style x:Key="BeautifulScrollViewer" TargetType="{x:Type ScrollViewer}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ScrollViewer}">
                        <Grid x:Name="Grid" Background="{TemplateBinding Background}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Rectangle x:Name="Corner" Grid.Row="1" Grid.Column="1" Fill="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>

                            <ScrollContentPresenter x:Name="PART_ScrollContentPresenter"
                                                Grid.Row="0"
                                                Grid.Column="0"
                                                Margin="{TemplateBinding Padding}"
                                                CanContentScroll="{TemplateBinding CanContentScroll}"
                                                CanHorizontallyScroll="False"
                                                CanVerticallyScroll="False"
                                                Content="{TemplateBinding Content}"
                                                ContentTemplate="{TemplateBinding ContentTemplate}"/>

                            <ScrollBar x:Name="PART_VerticalScrollBar"
                                   Grid.Row="0"
                                   Grid.Column="1"
                                   AutomationProperties.AutomationId="VerticalScrollBar"
                                   Cursor="Arrow"
                                   Maximum="{TemplateBinding ScrollableHeight}"
                                   Minimum="0"
                                   Style="{StaticResource CustomScrollBar}"
                                   ViewportSize="{TemplateBinding ViewportHeight}"
                                   Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"
                                   Value="{Binding VerticalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"/>

                            <ScrollBar x:Name="PART_HorizontalScrollBar"
                                   Grid.Row="1"
                                   Grid.Column="0"
                                   AutomationProperties.AutomationId="HorizontalScrollBar"
                                   Cursor="Arrow"
                                   Maximum="{TemplateBinding ScrollableWidth}"
                                   Minimum="0"
                                   Orientation="Horizontal"
                                   ViewportSize="{TemplateBinding ViewportWidth}"
                                   Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"
                                   Value="{Binding HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Стили остаются без изменений -->
        <Style x:Key="MenuHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#0167a4"/>
            <Setter Property="FontFamily" Value="Raleway"/>
        </Style>

        <Style x:Key="SubMenuStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#0167a4"/>
            <Setter Property="FontFamily" Value="Raleway"/>
        </Style>
        <Style x:Key="SubMenuStyle1" TargetType="TextBlock">
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#8a8a8a"/>
            <Setter Property="FontFamily" Value="Raleway"/>
        </Style>

        <Style x:Key="MenuItemStyle" TargetType="Border">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <Style x:Key="ActiveMainItemStyle" TargetType="Border" BasedOn="{StaticResource MenuItemStyle}">
            <Setter Property="CornerRadius" Value="0,15,15,0"/>
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                        <GradientStop Color="#0167a4" Offset="0"/>
                        <GradientStop Color="#005e9d" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="TextElement.Foreground" Value="White"/>
        </Style>

        <Style x:Key="ActiveSubItemStyle" TargetType="Border" BasedOn="{StaticResource MenuItemStyle}">
            <Setter Property="CornerRadius" Value="0,15,15,0"/>
            <Setter Property="TextElement.Foreground" Value="White"/>
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                        <GradientStop Color="#5394ba" Offset="0"/>
                        <GradientStop Color="#0167a4" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ActiveSubItemLevel2Style" TargetType="Border" BasedOn="{StaticResource MenuItemStyle}">
            <Setter Property="CornerRadius" Value="0,15,15,0"/>
            <Setter Property="TextElement.Foreground" Value="White"/>
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                        <GradientStop Color="#b8d3df" Offset="0"/>
                        <GradientStop Color="#5394ba" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ActiveItemStyle" TargetType="Border" BasedOn="{StaticResource MenuItemStyle}">
            <Setter Property="Background" Value="#005e9d"/>
            <Setter Property="BorderBrush" Value="#004777"/>
            <Setter Property="BorderThickness" Value="4,0,0,0"/>
        </Style>
        <Style x:Key="SearchBoxBorderStyle" TargetType="Border">
            <Setter Property="Background" Value="#f8f9fa"/>
            <Setter Property="BorderBrush" Value="#c4c4c4"/>
            <Setter Property="BorderThickness" Value="3"/>
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Padding" Value="2"/>
            <Setter Property="Margin" Value="5,0,5,5"/>
        </Style>
        <Style x:Key="CalendarNavButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Foreground" Value="#0167a4"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Width" Value="30"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                        CornerRadius="15">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#f0f0f0"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <!-- Стиль для вложенных подразделов (3-й уровень) -->
        <Style x:Key="MenuItemSubSubStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="Foreground" Value="#6c757d"/>
            <Setter Property="FontFamily" Value="Raleway"/>
            <Setter Property="Margin" Value="12,0,0,0"/>
            <!-- Отступ слева -->
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="180"/>
        </Grid.ColumnDefinitions>

        <!-- Левая навигационная панель -->
        <Border Grid.Column="0"
                Background="#f8f9fa"
                BorderBrush="#d8e0e5"
                BorderThickness="0,0,1,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Основное содержимое меню -->
                <ScrollViewer Grid.Row="0"
              Style="{StaticResource BeautifulScrollViewer}"
              VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- Логотип -->
                        <StackPanel Margin="10" HorizontalAlignment="Center">
                            <Image Source="/images/logo.jpg"
                                   Width="180"
                                   Height="90"
                                   Stretch="Fill"/>
                        </StackPanel>

                        <Rectangle Height="1" Fill="#d6e2ea" Margin="10,0,10,10"/>

                        <!-- Меню навигации -->
                        <StackPanel>
                            <!-- Поиск -->
                            <Border Style="{StaticResource SearchBoxBorderStyle}">
                                <Grid>
                                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                        <Image Source="/images/search.jpg" Width="16" Height="16" Margin="5,0"/>
                                        <TextBox x:Name="SearchBox"
                     Width="200"
                     Margin="5,0"
                     Padding="5,2"
                     Background="#f8f9fa"
                     BorderThickness="0"
                     Foreground="#495057"
                     FontSize="12"
                     TextChanged="SearchBox_TextChanged"/>
                                    </StackPanel>
                                    <TextBlock x:Name="SearchPlaceholder"
                   Text="Поиск"
                   Foreground="#8a8a8a"
                   Margin="30,2,0,0"
                   VerticalAlignment="Center"
                   IsHitTestVisible="False"/>
                                </Grid>
                            </Border>

                            <!-- Отчет по НИР -->
                            <StackPanel>
                                <Border x:Name="NIR_Header"
                                        Tag="main"
                                        MouseLeftButtonDown="NIR_Header_Click"
                                        Style="{StaticResource MenuItemStyle}">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Отчет по НИР" Style="{StaticResource MenuHeaderStyle}"/>
                                        <Image x:Name="NIR_Arrow" Source="/images/arrow.jpg" Width="12" Height="12" Margin="6,2,0,0"/>
                                    </StackPanel>
                                </Border>

                                <StackPanel x:Name="NIR_Menu" Visibility="Collapsed">
                                    <!-- Титульный лист -->
                                    <Border x:Name="Item_Title"
                                            Tag="sub"
                                            MouseLeftButtonDown="MenuItem_Click"
                                            Style="{StaticResource MenuItemStyle}">
                                        <TextBlock Text="Титульный лист" Style="{StaticResource SubMenuStyle}"/>
                                    </Border>

                                    <!-- Раздел 1 -->
                                    <StackPanel>
                                        <Border x:Name="Section1_Header"
                                                Tag="sub"
                                                MouseLeftButtonDown="Section1_Header_Click"
                                                Style="{StaticResource MenuItemStyle}">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="Раздел 1" Style="{StaticResource SubMenuStyle}"/>
                                                <Image x:Name="NIR_Arrow1" Source="/images/arrow.jpg" Width="12" Height="12" Margin="6,2,0,0"/>
                                            </StackPanel>
                                        </Border>

                                        <StackPanel x:Name="Section1_Menu" Visibility="Collapsed">
                                            <Border x:Name="Item_11" MouseLeftButtonDown="Item_11_Click"
                                                    Tag="sub2"
                                                    Style="{StaticResource MenuItemStyle}">
                                                <TextBlock Text="1.1 Общая характеристика научных исследований"
                                                       Style="{StaticResource SubMenuStyle1}"/>
                                            </Border>
                                            <Border x:Name="Item_12" MouseLeftButtonDown="Item_12_Click"
        Tag="sub2"
        Style="{StaticResource MenuItemStyle}">
                                                <TextBlock Text="1.2 Хоздоговорные НИР"
               Style="{StaticResource SubMenuStyle1}"/>
                                            </Border>
                                            <Border x:Name="Item_13" MouseLeftButtonDown="Item_13_Click"
                                                    Tag="sub2"
                                                    Style="{StaticResource MenuItemStyle}">
                                                <TextBlock Text="1.3 Темы госбюджетных НИ"
                                                       Style="{StaticResource SubMenuStyle1}"/>
                                            </Border>
                                            <Border x:Name="Item_14" MouseLeftButtonDown="Item_14_Click"
                                                    Tag="sub2"
                                                    Style="{StaticResource MenuItemStyle}">
                                                <TextBlock Text="1.4 Реализация результатов НИОКР"
                                                       Style="{StaticResource SubMenuStyle1}"/>
                                            </Border>
                                            <Border x:Name="Item_15" MouseLeftButtonDown="Item_15_Click"
                                                    Tag="sub2"
                                                    Style="{StaticResource MenuItemStyle}">
                                                <TextBlock Text="1.5 Международные творческие связи и содружество с производством"
                                                       Style="{StaticResource SubMenuStyle1}" TextWrapping="Wrap"/>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>
                                    <!-- Раздел 2 -->
                                    <StackPanel>
                                        <Border x:Name="Section2_Header"
            Tag="sub"
            MouseLeftButtonDown="Section2_Header_Click"
            Style="{StaticResource MenuItemStyle}">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="Раздел 2" Style="{StaticResource SubMenuStyle}"/>
                                                <Image x:Name="NIR_Arrow2" Source="/images/arrow.jpg" Width="12" Height="12" Margin="6,2,0,0"/>
                                            </StackPanel>
                                        </Border>

                                        <StackPanel x:Name="Section2_Menu" Visibility="Collapsed">
                                            <Border x:Name="Item_21" MouseLeftButtonDown="Item_21_Click"
                Tag="sub2"
                Style="{StaticResource MenuItemStyle}">
                                                <TextBlock Text="АСПИРАНТУРА"
                       Style="{StaticResource SubMenuStyle1}"/>
                                            </Border>
                                            <Border x:Name="Item_22" MouseLeftButtonDown="Item_22_Click"
                Tag="sub2"
                Style="{StaticResource MenuItemStyle}">
                                                <TextBlock Text="ДОКТОРАНТУРА"
                       Style="{StaticResource SubMenuStyle1}"/>
                                            </Border>
                                            <Border x:Name="Item_23" MouseLeftButtonDown="Item_23_Click"
                Tag="sub2"
                Style="{StaticResource MenuItemStyle}">
                                                <TextBlock Text="ЗАЩИТЫ"
                       Style="{StaticResource SubMenuStyle1}"/>
                                            </Border>
                                            <Border x:Name="Item_24" MouseLeftButtonDown="Item_24_Click"
                Tag="sub2"
                Style="{StaticResource MenuItemStyle}">
                                                <TextBlock Text="ПЛАН ЗАЩИТ"
                       Style="{StaticResource SubMenuStyle1}"/>
                                            </Border>
                                            <Border x:Name="Item_25" MouseLeftButtonDown="Item_25_Click"
                Tag="sub2"
                Style="{StaticResource MenuItemStyle}">
                                                <TextBlock Text="ДИССЕРТАЦИОННЫЕ СОВЕТЫ"
                       Style="{StaticResource SubMenuStyle1}" TextWrapping="Wrap"/>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>
                                    <!-- Раздел 3 -->
                                    <StackPanel>
                                        <Border x:Name="Section3_Header"
            Tag="sub"
            MouseLeftButtonDown="Section3_Header_Click"
            Style="{StaticResource MenuItemStyle}">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="Раздел 3" Style="{StaticResource SubMenuStyle}"/>
                                                <Image x:Name="NIR_Arrow3" Source="/images/arrow.jpg" Width="12" Height="12" Margin="6,2,0,0"/>
                                            </StackPanel>
                                        </Border>

                                        <StackPanel x:Name="Section3_Menu" Visibility="Collapsed">
                                            <Border x:Name="Item_31" MouseLeftButtonDown="Item_31_Click"
                Tag="sub2"
                Style="{StaticResource MenuItemStyle}">
                                                <TextBlock Text="Издательская деятельность сотрудников кафедры и лаборатории"
                       Style="{StaticResource SubMenuStyle1}" TextWrapping="Wrap"/>
                                            </Border>
                                            <Border x:Name="Item_32" MouseLeftButtonDown="Item_32_Click"
                Tag="sub2"
                Style="{StaticResource MenuItemStyle}">
                                                <TextBlock Text="Публикационная активность профессорско-преподавательского состава кафедры и научных сотрудников лаборатории"
                       Style="{StaticResource SubMenuStyle1}" TextWrapping="Wrap"/>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>
                                    <!-- Раздел 4 -->
                                    <StackPanel>
                                        <Border x:Name="Section4_Header"
            Tag="sub"
            MouseLeftButtonDown="Section4_Header_Click"
            Style="{StaticResource MenuItemStyle}">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="Раздел 4" Style="{StaticResource SubMenuStyle}"/>
                                                <Image x:Name="NIR_Arrow4" Source="/images/arrow.jpg" Width="12" Height="12" Margin="6,2,0,0"/>
                                            </StackPanel>
                                        </Border>

                                        <StackPanel x:Name="Section4_Menu" Visibility="Collapsed">
                                            <Border x:Name="Item_41" MouseLeftButtonDown="Item_41_Click"
                Tag="sub2"
                Style="{StaticResource MenuItemStyle}">
                                                <TextBlock Text="Общие сведения"
                       Style="{StaticResource SubMenuStyle1}" TextWrapping="Wrap"/>
                                            </Border>
                                            <Border x:Name="Item_42" MouseLeftButtonDown="Item_42_Click"
                Tag="sub2"
                Style="{StaticResource MenuItemStyle}">
                                                <TextBlock Text="Полученные патенты/положительные решения на изобретения и полезные модели"
                       Style="{StaticResource SubMenuStyle1}" TextWrapping="Wrap"/>
                                            </Border>
                                            <Border x:Name="Item_43" MouseLeftButtonDown="Item_43_Click"
                Tag="sub2"
                Style="{StaticResource MenuItemStyle}">
                                                <TextBlock Text="Полученные свидетельства на программные продукты и базы данных, электронные ресурсы"
                       Style="{StaticResource SubMenuStyle1}" TextWrapping="Wrap"/>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>

                                    <!-- Раздел 5 -->
                                    <StackPanel>
                                        <Border x:Name="Section5_Header"
            Tag="sub"
            MouseLeftButtonDown="Section5_Header_Click"
            Style="{StaticResource MenuItemStyle}">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="Раздел 5" Style="{StaticResource SubMenuStyle}"/>
                                                <Image x:Name="NIR_Arrow5" Source="/images/arrow.jpg" Width="12" Height="12" Margin="6,2,0,0"/>
                                            </StackPanel>
                                        </Border>

                                        <StackPanel x:Name="Section5_Menu" Visibility="Collapsed">
                                            <!-- Реализуемые стартап-проекты (с подменю) -->
                                            <StackPanel>
                                                <Border x:Name="Item_51"
            Tag="sub2"
            MouseLeftButtonDown="Item_51_Click"
            Style="{StaticResource MenuItemStyle}">
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="Реализуемые стартап-проекты"
                       Style="{StaticResource SubMenuStyle1}" TextWrapping="Wrap"/>
                                                        <Image x:Name="NIR_Arrow51" Source="/images/arrow.jpg" Width="12" Height="12" Margin="6,2,0,0"/>
                                                    </StackPanel>
                                                </Border>
                                                <StackPanel x:Name="Item_51_SubMenu" Visibility="Collapsed">
                                                    <Border x:Name="Item_51a" MouseLeftButtonDown="Item_51a_Click"
                Tag="sub2"
                Style="{StaticResource MenuItemStyle}">
                                                        <TextBlock Text="Планируемые стартап-проекты"
                       Style="{StaticResource MenuItemSubSubStyle}" TextWrapping="Wrap"/>
                                                    </Border>
                                                </StackPanel>
                                            </StackPanel>
                                            <!-- Участие в конкурсах, грантах -->
                                            <Border x:Name="Item_52" MouseLeftButtonDown="Item_52_Click"
                Tag="sub2"
                Style="{StaticResource MenuItemStyle}">
                                                <TextBlock Text="Участие в конкурсах, грантах"
                       Style="{StaticResource SubMenuStyle1}" TextWrapping="Wrap"/>
                                            </Border>

                                            <!-- Научные конференции (с подменю) -->
                                            <StackPanel>
                                                <Border x:Name="Item_53"
            Tag="sub2"
            MouseLeftButtonDown="Item_53_Click"
            Style="{StaticResource MenuItemStyle}">
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="Научные конференции"
                       Style="{StaticResource SubMenuStyle1}" TextWrapping="Wrap"/>
                                                        <Image x:Name="NIR_Arrow53" Source="/images/arrow.jpg" Width="12" Height="12" Margin="6,2,0,0"/>
                                                    </StackPanel>
                                                </Border>
                                                <StackPanel x:Name="Item_53_SubMenu" Visibility="Collapsed">
                                                    <Border x:Name="Item_53a" MouseLeftButtonDown="Item_53a_Click"
                Tag="sub2"
                Style="{StaticResource MenuItemStyle}">
                                                        <TextBlock Text="Организованные конференции"
                       Style="{StaticResource MenuItemSubSubStyle}" TextWrapping="Wrap"/>
                                                    </Border>
                                                    <Border x:Name="Item_53b" MouseLeftButtonDown="Item_53b_Click"
                Tag="sub2"
                Style="{StaticResource MenuItemStyle}">
                                                        <TextBlock Text="План проведения конференций, семинаров, совещаний в 2025 г."
                       Style="{StaticResource MenuItemSubSubStyle}" TextWrapping="Wrap"/>
                                                    </Border>
                                                </StackPanel>
                                            </StackPanel>

                                            <!-- Участие в выставках-ярмарках -->
                                            <Border x:Name="Item_54" MouseLeftButtonDown="Item_54_Click"
                Tag="sub2"
                Style="{StaticResource MenuItemStyle}">
                                                <TextBlock Text="Участие в выставках-ярмарках"
                       Style="{StaticResource SubMenuStyle1}" TextWrapping="Wrap"/>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>

                                    <!-- Раздел 6 (остаётся простым, без подменю) -->
                                    <Border x:Name="Section6_Header" Tag="sub" MouseLeftButtonDown="MenuItem_Click" Style="{StaticResource MenuItemStyle}">
                                        <TextBlock Text="Раздел 6" Style="{StaticResource SubMenuStyle}"/>
                                    </Border>

                                    <!-- Новые разделы 7, 8, 9 -->
                                    <Border x:Name="Section7_Header" Tag="sub" MouseLeftButtonDown="Section7_Header_Click" Style="{StaticResource MenuItemStyle}">
                                        <TextBlock Text="Раздел 7" Style="{StaticResource SubMenuStyle}"/>
                                    </Border>
                                    <Border x:Name="Section8_Header" Tag="sub" MouseLeftButtonDown="MenuItem_Click" Style="{StaticResource MenuItemStyle}">
                                        <TextBlock Text="Раздел 8" Style="{StaticResource SubMenuStyle}"/>
                                    </Border>
                                    <Border x:Name="Section9_Header" Tag="sub" MouseLeftButtonDown="Section9_Header_Click" Style="{StaticResource MenuItemStyle}">
                                        <TextBlock Text="Раздел 9" Style="{StaticResource SubMenuStyle}"/>
                                    </Border>
                                </StackPanel>
                            </StackPanel>
                            <!-- Остальные пункты меню -->
                            <Border x:Name="Item_Study" MouseLeftButtonDown="MenuItem_Click" Tag="main" Style="{StaticResource MenuItemStyle}">
                                <TextBlock Text="Учебный отчет" Style="{StaticResource MenuHeaderStyle}"/>
                            </Border>
                            <Border x:Name="Item_Archive" MouseLeftButtonDown="Item_Archive_Click" Tag="main" Style="{StaticResource MenuItemStyle}">
                                <TextBlock Text="Архив" Style="{StaticResource MenuHeaderStyle}"/>
                            </Border>
                            <Border x:Name="Item_Templates" MouseLeftButtonDown="MenuItem_Click" Tag="main" Style="{StaticResource MenuItemStyle}">
                                <TextBlock Text="Шаблоны" Style="{StaticResource MenuHeaderStyle}"/>
                            </Border>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
                <!-- Справка - в самом низу -->
                <StackPanel Grid.Row="1" Margin="0,10,0,10">
                    <Rectangle Height="1" Fill="#d6e2ea" Margin="10,0,10,10"/>
                    <Border Style="{StaticResource MenuItemStyle}">
                        <TextBlock Text="Справка" Style="{StaticResource MenuHeaderStyle}"/>
                    </Border>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Основной контент -->
        <Border Grid.Column="1" Background="#e8e8e8">
            <ContentControl x:Name="MainContentControl">
                <ContentControl.Content>
                    <TextBlock Text="Основная область контента"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       Foreground="#6c757d"
                       FontSize="16"/>
                </ContentControl.Content>
            </ContentControl>
        </Border>

        <!-- Правая панель с кнопками внизу -->
        <Border Grid.Column="2"
        Background="#f1f3f5"
        BorderBrush="#d6e2ea"
        BorderThickness="1,0,0,0">
            <Grid Cursor="">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Блок с периодом - остается наверху -->
                <Border Background="White"
        CornerRadius="10"
        Padding="10"
        Margin="10"
        BorderBrush="#d6e2ea"
        BorderThickness="1"
        VerticalAlignment="Top">
                    <StackPanel HorizontalAlignment="Center">
                        <TextBlock Text="Период" FontWeight="Bold" Foreground="#0167a4"/>

                        <!-- Кликабельная область для выбора периода -->
                        <Button x:Name="PeriodSelector" 
        Click="PeriodSelector_Click"
        Background="Transparent"
        BorderThickness="0"
        Cursor="Hand">
                            <!-- Содержимое вашей кнопки выбора периода -->
                            <StackPanel Orientation="Horizontal">
                                <TextBlock x:Name="DateRangeText" Text="01.01 - 31.12"/>
                                <TextBlock x:Name="YearText" Text="2025" Margin="5,0,0,0"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </Border>
                <Popup x:Name="CalendarPopup" 
       Placement="Bottom" 
       PlacementTarget="{Binding ElementName=PeriodSelector}"
       StaysOpen="False"
       AllowsTransparency="True"
       PopupAnimation="Slide">
                    <Border Background="White" 
            BorderBrush="#d6e2ea" 
            BorderThickness="1"
            CornerRadius="12"
            Padding="20"
            Margin="0,8,0,0">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="15" Opacity="0.1" ShadowDepth="3" Color="Black"/>
                        </Border.Effect>
                        <StackPanel>
                            <TextBlock Text="Период" 
                       FontWeight="Bold" 
                       Foreground="#0167a4"
                       FontSize="16"
                       Margin="0,0,0,15"
                       HorizontalAlignment="Center"/>

                            <!-- Месяц и год -->
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,15">
                                <Button Content="‹" 
                        Style="{StaticResource CalendarNavButtonStyle}"
                        Click="PreviousMonth_Click"/>
                                <TextBlock x:Name="CurrentMonthYear" 
                           Text="Октябрь 2025" 
                           FontWeight="SemiBold"
                           FontSize="14"
                           Foreground="#495057"
                           VerticalAlignment="Center"
                           Margin="15,0"/>
                                <Button Content="›" 
                        Style="{StaticResource CalendarNavButtonStyle}"
                        Click="NextMonth_Click"/>
                            </StackPanel>

                            <!-- Дни недели -->
                            <Grid Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Пн" Grid.Column="0" HorizontalAlignment="Center" FontSize="11" Foreground="#6c757d"/>
                                <TextBlock Text="Вт" Grid.Column="1" HorizontalAlignment="Center" FontSize="11" Foreground="#6c757d"/>
                                <TextBlock Text="Ср" Grid.Column="2" HorizontalAlignment="Center" FontSize="11" Foreground="#6c757d"/>
                                <TextBlock Text="Чт" Grid.Column="3" HorizontalAlignment="Center" FontSize="11" Foreground="#6c757d"/>
                                <TextBlock Text="Пт" Grid.Column="4" HorizontalAlignment="Center" FontSize="11" Foreground="#6c757d"/>
                                <TextBlock Text="Сб" Grid.Column="5" HorizontalAlignment="Center" FontSize="11" Foreground="#6c757d"/>
                                <TextBlock Text="Вс" Grid.Column="6" HorizontalAlignment="Center" FontSize="11" Foreground="#6c757d"/>
                            </Grid>

                            <!-- Календарь -->
                            <ItemsControl x:Name="CalendarDays" 
                          HorizontalAlignment="Center">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <UniformGrid Columns="7" Rows="6"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Width="30" Height="30" 
                                Background="{Binding BackgroundColor}" 
                                CornerRadius="15"
                                Margin="2"
                                Cursor="Hand"
                                MouseLeftButtonUp="CalendarDay_MouseLeftButtonUp">
                                            <TextBlock Text="{Binding Day}" 
                                       HorizontalAlignment="Center" 
                                       VerticalAlignment="Center"
                                       FontSize="11"
                                       Foreground="{Binding TextColor}"
                                       FontWeight="{Binding FontWeight}"/>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>

                            <!-- Выбранный период -->
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,15,0,10">
                                <!-- Начальная дата -->
                                <Border Background="#f8f9fa" CornerRadius="6" Padding="12" Margin="0,0,20,0">
                                    <StackPanel>
                                        <TextBlock Text="Период с:" 
                                   FontSize="11" 
                                   Foreground="#6c757d"
                                   FontWeight="SemiBold"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,8"/>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <!-- День начала -->
                                            <ComboBox x:Name="StartDayComboBox" 
                                      Width="40" 
                                      FontSize="11"
                                      Margin="0,0,4,0"
                                      SelectionChanged="StartDate_SelectionChanged"/>
                                            <!-- Месяц начала -->
                                            <ComboBox x:Name="StartMonthComboBox" 
                                      Width="50" 
                                      FontSize="11"
                                      Margin="0,0,4,0"
                                      SelectionChanged="StartDate_SelectionChanged"/>
                                            <!-- Год начала -->
                                            <ComboBox x:Name="StartYearComboBox" 
                                      Width="50" 
                                      FontSize="11"
                                      SelectionChanged="StartDate_SelectionChanged"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <!-- Конечная дата -->
                                <Border Background="#f8f9fa" CornerRadius="6" Padding="12">
                                    <StackPanel>
                                        <TextBlock Text="по:" 
                                   FontSize="11" 
                                   Foreground="#6c757d"
                                   FontWeight="SemiBold"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,8"/>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <!-- День конца -->
                                            <ComboBox x:Name="EndDayComboBox" 
                                      Width="40" 
                                      FontSize="11"
                                      Margin="0,0,4,0"
                                      SelectionChanged="EndDate_SelectionChanged"/>
                                            <!-- Месяц конца -->
                                            <ComboBox x:Name="EndMonthComboBox" 
                                      Width="50" 
                                      FontSize="11"
                                      Margin="0,0,4,0"
                                      SelectionChanged="EndDate_SelectionChanged"/>
                                            <!-- Год конца -->
                                            <ComboBox x:Name="EndYearComboBox" 
                                      Width="50" 
                                      FontSize="11"
                                      SelectionChanged="EndDate_SelectionChanged"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- Кнопка применения -->
                            <Button Content="Применить" 
                    Click="ApplyDateRange_Click"
                    Background="#0167a4"
                    Foreground="White"
                    Padding="20,8"
                    FontSize="12"
                    FontWeight="SemiBold"
                    BorderThickness="0"
                    HorizontalAlignment="Center"
                    MinWidth="120">
                                <Button.Effect>
                                    <DropShadowEffect BlurRadius="4" Opacity="0.2" ShadowDepth="2"/>
                                </Button.Effect>
                            </Button>
                        </StackPanel>
                    </Border>
                </Popup>
                <!-- Кнопки - перемещены вниз -->
                <StackPanel Grid.Row="1" Margin="10">
                    <!-- Кнопка "История изменений" -->
                    <Button Height="40"
            Background="White"
            Foreground="#0167a4"
            BorderBrush="#d6e2ea"
            BorderThickness="1"
            FontWeight="SemiBold"
            Padding="10,2">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        CornerRadius="15"
                        Padding="{TemplateBinding Padding}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                        <TextBlock Text="История&#x0a;изменений" 
                   TextAlignment="Center" 
                   TextWrapping="Wrap"/>
                    </Button>
                    <!-- Кнопка "Сформировать итоговый отчет" -->
                    <Button Height="45"
            Background="#0167a4" 
            Foreground="White" 
            FontWeight="SemiBold"
            BorderThickness="0"
            Padding="10,2"
            Margin="0,5,0,0">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        CornerRadius="15"
                        Padding="{TemplateBinding Padding}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                        <TextBlock Text="Сформировать&#x0a;итоговый отчет" 
                   TextAlignment="Center" 
                   TextWrapping="Wrap"/>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>